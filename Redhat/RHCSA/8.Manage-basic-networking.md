
# Identify your network bits quickly

* Show devices and active connections
  `nmcli dev status`
  `nmcli con show --active`
* Inspect a specific connection
  `nmcli con show "<conn_name>"`
* IP and routes
  `ip a`
  `ip r`
  `ip -6 r`

Opinionated tip: live in `nmcli`. Editing ifcfg files is old school trivia. RHCSA wants fast, correct NetworkManager work.

# Configure IPv4 addressing

Static

```bash
IF=ens224
CONN="$(nmcli -t -f NAME,DEVICE con show | awk -F: -v d="$IF" '$2==d{print $1;exit}')"
nmcli con mod "$CONN" ipv4.addresses "192.0.2.50/24" ipv4.gateway "192.0.2.1" \
  ipv4.dns "1.1.1.1 8.8.8.8" ipv4.method manual
nmcli con up "$CONN"
```

DHCP

```bash
nmcli con mod "$CONN" ipv4.method auto ipv4.ignore-auto-dns no
nmcli con up "$CONN"
```

Quick checks

```bash
ip a show dev "$IF"
ip r
nmcli dev show "$IF" | grep -i dns
ping -c 2 1.1.1.1
```

# Configure IPv6 addressing

Static

```bash
nmcli con mod "$CONN" ipv6.addresses "2001:db8:1::50/64" ipv6.gateway "2001:db8:1::1" \
  ipv6.dns "2606:4700:4700::1111 2001:4860:4860::8888" ipv6.method manual
nmcli con up "$CONN"
```

Autoconfiguration

```bash
nmcli con mod "$CONN" ipv6.method auto
nmcli con up "$CONN"
```

Checks

```bash
ip -6 a show dev "$IF"
ip -6 r
ping -6 -c 2 2606:4700:4700::1111
```

# Configure hostname and name resolution

Set hostname

```bash
hostnamectl set-hostname server01.lab.local
hostnamectl
```

DNS through NetworkManager

```bash
nmcli con mod "$CONN" ipv4.dns "192.0.2.53" ipv4.dns-search "lab.local" \
  ipv4.ignore-auto-dns yes
nmcli con up "$CONN"
```

Hosts file for static mapping

```bash
sudoedit /etc/hosts
# 192.0.2.20  repo.lab.local repo
getent hosts repo
```

See current resolvers

```bash
cat /etc/resolv.conf
nmcli dev show "$IF" | grep -i dns
getent hosts redhat.com
```

# Enable network services at boot

Start now and enable on boot

```bash
sudo systemctl enable --now NetworkManager
sudo systemctl enable --now firewalld
sudo systemctl enable --now sshd
# Example service like web
sudo systemctl enable --now httpd
```

Verify enablement

```bash
systemctl is-enabled NetworkManager firewalld sshd httpd
systemctl status httpd
ss -tulpen | grep -E ':(22|80)\b'
```

# Restrict access with firewalld and firewall-cmd

Know your zones

```bash
firewall-cmd --get-zones
firewall-cmd --get-default-zone
firewall-cmd --get-active-zones
```

Put an interface in the right zone and persist it

```bash
firewall-cmd --zone=public --change-interface="$IF"
nmcli con mod "$CONN" connection.zone public
```

Allow common services

```bash
firewall-cmd --zone=public --add-service=ssh
firewall-cmd --zone=public --add-service=http
# Make it stick
firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --reload
firewall-cmd --zone=public --list-all
```

Open a specific port

```bash
firewall-cmd --zone=public --add-port=8080/tcp
firewall-cmd --permanent --zone=public --add-port=8443/tcp
firewall-cmd --reload
```

Limit access to a subnet with a rich rule

```bash
firewall-cmd --permanent --zone=public \
  --add-rich-rule='rule family="ipv4" source address="192.0.2.0/24" service name="http" accept'
firewall-cmd --permanent --zone=public \
  --add-rich-rule='rule family="ipv4" service name="http" drop'
firewall-cmd --reload
```

IPv6 rich rule example

```bash
firewall-cmd --permanent --zone=public \
  --add-rich-rule='rule family="ipv6" source address="2001:db8:1::/64" port protocol="tcp" port="22" accept'
firewall-cmd --reload
```

Remove what you added

```bash
firewall-cmd --zone=public --remove-service=http
firewall-cmd --permanent --zone=public --remove-port=8443/tcp
firewall-cmd --permanent --zone=public \
  --remove-rich-rule='rule family="ipv4" source address="192.0.2.0/24" service name="http" accept'
firewall-cmd --reload
```

Masquerading and simple forwarding

```bash
# Enable NAT on an egress zone
firewall-cmd --add-masquerade --zone=public --permanent
# Forward port 8080 on this host to 10.10.10.5:80
firewall-cmd --permanent --zone=public \
  --add-forward-port=port=8080:proto=tcp:toaddr=10.10.10.5:toport=80
firewall-cmd --reload
```

Runtime vs permanent sanity checks

```bash
firewall-cmd --zone=public --list-all          # runtime
firewall-cmd --zone=public --list-all --permanent
```

# Quick verification checklist

* `nmcli con up "$CONN"` shows success without red text
* `ip a` shows the address and correct prefix
* `ping` IPv4 works to default gateway and outside
* `ping -6` works when IPv6 is configured
* `hostnamectl` shows the exact hostname requested
* `getent hosts repo` returns the right IP after editing hosts or DNS
* `systemctl is-enabled <service>` returns enabled for services you set
* `firewall-cmd --list-all` shows only the services and ports you intended
* Access from another host matches your firewall rules. Trust, but verify

One more opinion for the road. Do everything with `nmcli` and `firewall-cmd`, then confirm with `ip`, `ss`, and `getent`. You will move faster, make fewer mistakes, and your future self will buy you coffee.
